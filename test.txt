attempt=0
while true; do
  /opt/kubernetes/bin/etcdctl get /coreos.com/network/config 
  
    if (( attempt > 20 )); then
        echo "timeout for waiting network config" > /opt/kubernetes/log/flannel-error.log
        exit 2
    fi

    /opt/kubernetes/bin/etcdctl    mk /coreos.com/network/config "{\"Network\":\"10.2.0.0/16\"}" >/dev/null 2>&1
    attempt=$((attempt+1))
    sleep 3
done
wait
